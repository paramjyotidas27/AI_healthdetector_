<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>AI Healthcare Questionnaire</title>
<style>
  :root{
    --blue:#0b5ed7; --bg-light:#eaf4ff; --card:#ffffff;
    --muted:#5a6b7a;
  }
  *{box-sizing:border-box}
  body{
    margin:0;font-family: system-ui, "Segoe UI", Roboto, Arial;
    background: linear-gradient(180deg,#f7fbff 0%, #ffffff 40%);
    color:#163248;
    -webkit-font-smoothing:antialiased;
  }
  header{
    background: linear-gradient(90deg,#cfe8ff,#e6f4ff);
    padding:42px 16px;
    text-align:center;
    border-bottom:4px solid rgba(11,94,215,0.06);
  }
  header h1{color:var(--blue);margin:0 0 6px;font-size:28px}
  header p{margin:0;color:var(--muted);max-width:820px;margin-inline:auto}

  .wrap{max-width:980px;margin:26px auto;padding:0 12px}
  .card{background:var(--card);border-radius:12px;padding:18px;box-shadow:0 8px 28px rgba(12,20,40,0.06)}
  .top-row{display:flex;gap:12px;align-items:center;justify-content:space-between;margin-bottom:12px}
  .age-block{display:flex;gap:12px;align-items:center}
  .age-block input[type=range]{width:280px}
  .age-value{font-weight:700;color:var(--blue);min-width:44px;text-align:center}

  .questions{display:grid;grid-template-columns:1fr 1fr;gap:10px}
  @media (max-width:820px){ .questions{grid-template-columns:1fr} }

  .q{
    padding:12px;border-radius:8px;border:1px solid #eef6ff;background:var(--bg-light);
    display:flex;flex-direction:column;gap:10px;
  }
  .q strong{color:var(--blue);font-size:14px}
  .yn{display:flex;gap:8px}
  .yn button{
    padding:8px 12px;border-radius:8px;border:1px solid rgba(11,94,215,0.08);
    background:#fff;color:var(--muted);cursor:pointer;font-weight:700;
  }
  .yn button.active{background:var(--blue);color:white;border:0}

  .controls{display:flex;gap:10px;justify-content:center;margin-top:16px}
  .btn{padding:10px 16px;border-radius:10px;border:0;cursor:pointer;font-weight:800}
  .btn.primary{background:var(--blue);color:white}
  .btn.ghost{background:transparent;border:1px solid rgba(11,94,215,0.12);color:var(--blue)}

  #resultsArea{margin-top:18px}
  .disease{
    padding:12px;border-radius:10px;border:1px solid #e8f3ff;background:#fff;margin-bottom:10px;
  }
  .disease .bar{height:10px;background:#f1f6ff;border-radius:999px;overflow:hidden;margin-top:8px}
  .disease .fill{height:100%;width:0;background:linear-gradient(90deg,var(--blue),#07a);}
  .meta{margin-top:8px;color:#4a5b6b;font-size:14px}

  /* review popup */
  .overlay{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(4,12,30,0.45);z-index:55}
  .popup{background:#fff;padding:18px;border-radius:10px;max-width:420px;width:92%;box-shadow:0 20px 60px rgba(4,12,30,0.25)}
  .popup h3{margin:0 0 8px;color:var(--blue)}
  .popup textarea{width:100%;min-height:86px;border-radius:8px;padding:8px;border:1px solid #e6eefc;resize:vertical}
  .popup .row{display:flex;gap:8px;justify-content:flex-end;margin-top:10px}
  .small{font-size:13px;color:var(--muted)}
  footer{margin:22px 0;text-align:center;color:var(--muted);font-size:13px}
</style>
</head>
<body>
  <header>
    <h1>AI Healthcare Checkup Detector</h1>
    <p>Answer 20 precise questions. Our AI estimates chances for Anaemia, Diabetes, Dengue, Chikungunya and Tuberculosis â€” with tailored remarks and safe home remedies.</p>
  </header>

  <div class="wrap">
    <div class="card">
      <div class="top-row">
        <div style="display:flex;flex-direction:column;">
          <div style="font-weight:800;color:#0b5ed7">Age Meter</div>
          <div class="small">Set your age first (required)</div>
        </div>
        <div class="age-block">
          <input id="age" type="range" min="0" max="100" value="0" oninput="onAgeChange(this.value)">
          <div class="age-value" id="ageVal">0</div>
        </div>
      </div>

      <div style="height:8px"></div>

      <div id="questions" class="questions" aria-live="polite"></div>

      <div class="controls">
        <button class="btn primary" id="analyzeBtn">Analyze</button>
        <button class="btn ghost" id="resetBtn">Reset</button>
      </div>

      <div id="resultsArea"></div>
      <div id="generalAdvice" class="meta" style="display:none"></div>
    </div>

    <footer>Built by Paramjyoti & Swarnajyoti â€¢ PM Shri Kendriya Vidyalaya Silchar â€¢ Â© 2025</footer>
  </div>

  <!-- review popup -->
  <div id="overlay" class="overlay" role="dialog" aria-modal="true">
    <div class="popup">
      <h3>ðŸ’¬ Quick review</h3>
      <div class="small">Share one short line about your experience (saved locally).</div>
      <textarea id="reviewText" placeholder="I liked the quick results..."></textarea>
      <div class="row" style="margin-top:8px">
        <button id="reviewClose" class="btn ghost">Close</button>
        <button id="reviewSubmit" class="btn primary">Submit</button>
      </div>
    </div>
  </div>

<script>
/* ===== QUESTIONS (20 precise) ===== */
const QLIST = [
  'Do you often feel tired or weak?',
  'Do you feel dizzy or light-headed frequently?',
  'Do you experience excessive thirst?',
  'Do you urinate more than usual (recently)?',
  'Have you had sudden unexplained weight loss?',
  'Have you experienced fever in the last 7 days?',
  'Have you noticed skin rashes or red spots?',
  'Do you have a cough lasting more than 2 weeks?',
  'Do you experience chest discomfort or difficulty breathing?',
  'Do you sweat a lot at night (night sweats)?',
  'Do you have a decreased appetite or nausea?',
  'Do you experience blurred vision or eye pain?',
  'Do your lips or nails look pale?',
  'Do you feel numbness/tingling in hands or feet?',
  'Do you have swelling in ankles/feet?',
  'Do you get body/joint pain after small effort?',
  'Have you recently been bitten by mosquitoes frequently?',
  'Do you feel nauseous or have vomiting episodes?',
  'Do you have trouble sleeping because of discomfort?',
  'Do you have frequent or severe headaches?'
];

const questionsDiv = document.getElementById('questions');
let answers = Array(QLIST.length).fill(false);

function buildQuestions(){
  questionsDiv.innerHTML = '';
  QLIST.forEach((text, idx)=>{
    const el = document.createElement('div');
    el.className = 'q';
    el.innerHTML = `
      <strong>Q${idx+1}.</strong>
      <div style="margin-top:6px">${text}</div>
      <div class="yn" role="radiogroup" aria-label="Question ${idx+1}">
        <button type="button" data-idx="${idx}" data-val="yes">Yes</button>
        <button type="button" data-idx="${idx}" data-val="no" class="active">No</button>
      </div>
    `;
    questionsDiv.appendChild(el);
  });

  // attach events
  document.querySelectorAll('.yn').forEach(group=>{
    group.addEventListener('click', (e)=>{
      const btn = e.target.closest('button');
      if(!btn) return;
      const idx = Number(btn.dataset.idx);
      const val = btn.dataset.val === 'yes';
      // toggle active
      group.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
      btn.classList.add('active');
      answers[idx] = val;
    });
  });
}
buildQuestions();

/* ===== age meter ===== */
function onAgeChange(v){
  document.getElementById('ageVal').innerText = v;
}

/* ===== scoring weights & compute =====
   We'll use reasonable weights for symptom->disease mapping.
*/
const WEIGHTS = {
  Anaemia: { q1:18, q2:8, q13:28, q14:10, q11:12 }, // tired,dizzy,pale,numbness,appetite
  Diabetes: { q3:25, q4:25, q5:12, q12:18, ageExtra: (a)=> a>45 ? 10:0 },
  Dengue: { q6:18, q7:22, q16:20, q17:15, q19:10 },
  Chikungunya: { q6:18, q16:30, q15:18, q20:12, q7:8 },
  Tuberculosis: { q8:30, q9:20, q10:18, q11:12, q17:10 }
};

// helper safe getter for answer idx (1-based keys in WEIGHTS use q#)
function ans(n){ return !!answers[n-1]; }

// compute percent score for each disease
function computeScores(age){
  // quick check: if no positive answers -> zeros
  const anyPositive = answers.some(v=>v===true);
  if(!anyPositive) return { Anaemia:0, Diabetes:0, Dengue:0, Chikungunya:0, Tuberculosis:0 };

  const raw = { Anaemia:0, Diabetes:0, Dengue:0, Chikungunya:0, Tuberculosis:0 };
  // Anaemia
  raw.Anaemia += ans(1) ? WEIGHTS.Anaemia.q1 : 0;
  raw.Anaemia += ans(2) ? WEIGHTS.Anaemia.q2 : 0;
  raw.Anaemia += ans(13) ? WEIGHTS.Anaemia.q13 : 0;
  raw.Anaemia += ans(14) ? WEIGHTS.Anaemia.q14 : 0;
  raw.Anaemia += ans(11) ? WEIGHTS.Anaemia.q11 : 0;

  // Diabetes
  raw.Diabetes += ans(3) ? WEIGHTS.Diabetes.q3 : 0;
  raw.Diabetes += ans(4) ? WEIGHTS.Diabetes.q4 : 0;
  raw.Diabetes += ans(5) ? WEIGHTS.Diabetes.q5 : 0;
  raw.Diabetes += ans(12) ? WEIGHTS.Diabetes.q12 : 0;
  raw.Diabetes += WEIGHTS.Diabetes.ageExtra(age);

  // Dengue
  raw.Dengue += ans(6) ? WEIGHTS.Dengue.q6 : 0;
  raw.Dengue += ans(7) ? WEIGHTS.Dengue.q7 : 0;
  raw.Dengue += ans(16) ? WEIGHTS.Dengue.q16 : 0;
  raw.Dengue += ans(17) ? WEIGHTS.Dengue.q17 : 0;
  raw.Dengue += ans(19) ? WEIGHTS.Dengue.q19 : 0;

  // Chikungunya
  raw.Chikungunya += ans(6) ? WEIGHTS.Chikungunya.q6 : 0;
  raw.Chikungunya += ans(16) ? WEIGHTS.Chikungunya.q16 : 0;
  raw.Chikungunya += ans(15) ? WEIGHTS.Chikungunya.q15 : 0;
  raw.Chikungunya += ans(20) ? WEIGHTS.Chikungunya.q20 : 0;
  raw.Chikungunya += ans(7) ? WEIGHTS.Chikungunya.q7 : 0;

  // Tuberculosis
  raw.Tuberculosis += ans(8) ? WEIGHTS.Tuberculosis.q8 : 0;
  raw.Tuberculosis += ans(9) ? WEIGHTS.Tuberculosis.q9 : 0;
  raw.Tuberculosis += ans(10) ? WEIGHTS.Tuberculosis.q10 : 0;
  raw.Tuberculosis += ans(11) ? WEIGHTS.Tuberculosis.q11 : 0;
  raw.Tuberculosis += ans(17) ? WEIGHTS.Tuberculosis.q17 : 0;

  // compute max possible for normalization
  const max = {
    Anaemia: Object.values(WEIGHTS.Anaemia).reduce((a,b)=>a+b,0),
    Diabetes: Object.values(WEIGHTS.Diabetes).filter(v=>typeof v==='number').reduce((a,b)=>a+b,0) + 10, // ageExtra included above
    Dengue: Object.values(WEIGHTS.Dengue).reduce((a,b)=>a+b,0),
    Chikungunya: Object.values(WEIGHTS.Chikungunya).reduce((a,b)=>a+b,0),
    Tuberculosis: Object.values(WEIGHTS.Tuberculosis).reduce((a,b)=>a+b,0)
  };

  // percent and clamp
  const perc = {};
  Object.keys(raw).forEach(k=>{
    let p = Math.round((raw[k] / max[k])*100);
    if(p<0) p=0; if(p>100) p=100;
    perc[k] = p;
  });
  return perc;
}

/* ===== display results cleanly ===== */
const resultsArea = document.getElementById('resultsArea');
const generalAdvice = document.getElementById('generalAdvice');

function showResults(percs){
  resultsArea.innerHTML = '';
  generalAdvice.style.display = 'none';

  // summary top text
  const highest = Object.keys(percs).reduce((a,b)=> percs[a]>=percs[b]?a:b);
  const highestVal = percs[highest];

  // build disease cards
  Object.keys(percs).forEach(d=>{
    const pct = percs[d];
    const card = document.createElement('div'); card.className='disease';
    card.innerHTML = `
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div style="font-weight:800;color:var(--blue)">${d}</div>
        <div style="font-weight:800">${pct}%</div>
      </div>
      <div class="bar"><div class="fill" id="fill-${d}"></div></div>
      <div class="meta">
        <div><strong>AI Remark:</strong> ${aiRemark(d,pct)}</div>
        <div style="margin-top:6px"><strong>Home Remedy:</strong> ${homeRemedy(d,pct)}</div>
        <div style="margin-top:6px"><strong>Medicine Tip:</strong> ${medicineTip(d,pct)}</div>
      </div>
    `;
    resultsArea.appendChild(card);
    // animate fill
    setTimeout(()=> {
      const f = document.getElementById('fill-'+d);
      if(f) f.style.width = pct + '%';
    },50);
  });

  // general advice
  const highs = Object.keys(percs).filter(k=>percs[k]>=60);
  const meds = Object.keys(percs).filter(k=>percs[k]>=40 && percs[k]<60);
  if(highs.length){
    generalAdvice.style.display='block';
    generalAdvice.innerHTML = `<strong style="color:#c24d4d">Immediate action:</strong> High probability for ${highs.join(', ')} â€” please consult a doctor urgently and get tests done.`;
  } else if(meds.length){
    generalAdvice.style.display='block';
    generalAdvice.innerHTML = `<strong style="color:#e09f3e">Monitor:</strong> Mild/moderate signals for ${meds.join(', ')} â€” follow remedies and consider a medical check-up if symptoms persist.`;
  } else {
    generalAdvice.style.display='block';
    generalAdvice.innerHTML = `<strong style="color:#2b8a3e">All clear:</strong> Low signals across the board â€” maintain healthy habits.`;
  }
}

/* ===== AI text helpers ===== */
function aiRemark(disease,pct){
  if(pct === 0) return "No indicators detected based on your answers.";
  if(pct < 30) return "Low chance. Keep a healthy routine and re-check if new symptoms appear.";
  if(pct < 60) return "Moderate chance â€” observe symptoms and consider seeking a check-up.";
  return "High chance â€” seek medical consultation and diagnostic tests immediately.";
}
function homeRemedy(disease,pct){
  const map = {
    Anaemia: "Eat iron-rich foods (spinach, beetroot, dates), include vitamin C for absorption.",
    Diabetes: "Avoid sugary drinks, take fenugreek/methi water, prefer whole grains and daily walks.",
    Dengue: "Rest well, drink plenty of fluids and oral rehydration; papaya leaf juice may help.",
    Chikungunya: "Rest, warm compresses for joints, turmeric milk and hydration can ease symptoms.",
    Tuberculosis: "Good nutrition, avoid smoking, and seek early medical tests for diagnosis."
  };
  if(pct === 0) return "No remedy needed â€” continue healthy diet & hydration.";
  if(pct < 60) return map[disease];
  return "Follow the remedy for support, but prioritize visiting a healthcare centre for diagnosis.";
}
function medicineTip(disease,pct){
  const map = {
    Anaemia: "Iron supplements may help (doctor-prescribed).",
    Diabetes: "Monitoring blood sugar is important; medicines are prescription-only.",
    Dengue: "Paracetamol for fever; avoid ibuprofen/aspirin until dengue is ruled out.",
    Chikungunya: "Paracetamol for pain/fever; see doctor if pain is severe.",
    Tuberculosis: "Requires prescription antibiotics (do not self-medicate)."
  };
  if(pct === 0) return "No medicine needed.";
  if(pct < 60) return map[disease] + " Consult if symptoms persist.";
  return map[disease] + " Urgent medical consultation required.";
}

/* ===== analyze button ===== */
document.getElementById('analyzeBtn').addEventListener('click', ()=>{
  const age = Number(document.getElementById('age').value);
  if(!age || age <= 0){ alert('Please set your age using the age meter first.'); return; }
  const percs = computeScores(age);
  showResults(percs);
  // show review popup after short delay
  setTimeout(()=> document.getElementById('overlay').style.display='flex', 1600);
});

/* ===== reset button ===== */
document.getElementById('resetBtn').addEventListener('click', resetAll);
function resetAll(){
  // reset age
  document.getElementById('age').value = 0;
  onAgeChange(0);
  // reset answers and UI
  answers = Array(QLIST.length).fill(false);
  document.querySelectorAll('.yn').forEach(g=>{
    g.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
    // set 'No' active
    const noBtn = g.querySelector('button[data-val="no"]');
    if(noBtn) noBtn.classList.add('active');
  });
  resultsArea.innerHTML = '';
  generalAdvice.style.display='none';
  document.getElementById('overlay').style.display='none';
}

/* ===== init: ensure all groups default to 'No' active ===== */
(function initDefaults(){
  document.querySelectorAll('.yn').forEach(group=>{
    group.querySelectorAll('button').forEach(b=>b.classList.remove('active'));
    const noBtn = group.querySelector('button[data-val="no"]');
    if(noBtn) noBtn.classList.add('active');
  });
})();

/* ===== review popup handlers ===== */
document.getElementById('reviewClose').addEventListener('click', ()=> document.getElementById('overlay').style.display='none');
document.getElementById('reviewSubmit').addEventListener('click', ()=>{
  const txt = document.getElementById('reviewText').value.trim();
  if(!txt){ alert('Please write a short feedback or press Close.'); return; }
  const arr = JSON.parse(localStorage.getItem('ai_reviews')||'[]');
  arr.push({text:txt, time:new Date().toISOString()});
  localStorage.setItem('ai_reviews', JSON.stringify(arr));
  alert('Thanks for your feedback! Saved locally.');
  document.getElementById('reviewText').value = '';
  document.getElementById('overlay').style.display='none';
});
</script>
</body>
</html>
